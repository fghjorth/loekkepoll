table(gd$age2013)
table(as.numeric(gd$edu))
gd$edulvl<-(as.numeric(gd$edu)-1)/8
gd$someuni<-ifelse(as.numeric(gd$edu)>6,1,0)
table(gdlabs$lmsit)
table(gd$lmsit)
gd$onlabmkt<-ifelse(gd$lmsit==1,1,0)
table(gdlabs$income_own_m)
gd$income<-ifelse(gd$income_own_m<14,(gd$income_own_m-1)/12,NA)
#stereotype congruence
gd$congruence<-NA
gd$congruence[gd$bulg01==1 & gd$nkids>2]<-1
gd$congruence[gd$bulg01==1 & gd$nkids<3]<-0
gd$congruence[gd$bulg01==0 & gd$nkids<3]<-1
gd$congruence[gd$bulg01==0 & gd$nkids>2]<-0
table(gd$congruence)
#reaction time to first q about experimental probe
gd$react1<-ifelse(gd$t_s2_q46_1>0 & gd$t_s2_q46_1<100,gd$t_s2_q46_1,NA)
hist(gd$react1)
gd$react2<-rank(gd$t_s2_q46_1)
gd$react3<-rank(gd$react1)
gd$react4<-log(gd$react1)
#how many does the trimming lose?
summary(gd$t_s2_q46_1)
summary(gd$react1)
#overview of data
str(gd)
#move constructed vars to the front to make it easier to inspect data
gd<-gd[,c(59:ncol(gd),1:58)]
#####################################
# REGS
#####################################
#regs
summary(m06<-lm(oppose~female+age2013+edulvl,data=gd))
summary(m07<-lm(oppose~female+age2013+edulvl+prej+eid,data=gd))
summary(m08<-lm(oppose~female+age2013+edulvl+prej+eid+stayhome+bulg01+nkids,data=gd))
summary(m08b<-lm(oppose~female+age2013+edulvl*bulg01+prej+eid+stayhome+nkids,data=gd)) #just to be clear - no different skill-based reaction to nationality
require(stargazer)
?stargazer
regtab0<-stargazer(m06,m07,m08,style="apsr",title="Models of opposition to cross-border welfare rights",intercept.bottom=F,digits=3,dep.var.caption="Opposed to cross-border welfare rights",dep.var.labels="Opposed to cross-border welfare rights",font.size="footnotesize",label="regtab0",column.sep.width="5pt",covariate.labels=c("Intercept","Gender (f)","Age","Education (some uni.)","Ethnic prejudice (EP)","Economic conservatism (EC)","Children stay","Bulgarian","No. children (NC)"),omit.stat=c("f"))
writeLines(regtab0,con="regtab0.txt")
summary(m09<-lm(m09f<-as.formula(oppose~female+age2013+edulvl+eid+stayhome+bulg01+prej*nkids),data=gd))
summary(m10<-lm(m10f<-as.formula(oppose~female+age2013+edulvl+stayhome+prej+bulg01+eid*nkids),data=gd))
summary(m11<-lm(m11f<-as.formula(oppose~female+age2013+edulvl+eid+stayhome+prej*bulg01+nkids),data=gd))
summary(m12<-lm(m12f<-as.formula(oppose~female+age2013+edulvl+stayhome+prej+eid*bulg01+nkids),data=gd))
regtab1<-stargazer(m11,m12,m09,m10,style="apsr",title="Models of opposition to cross-border welfare rights",intercept.bottom=F,digits=3,dep.var.caption="Opposed to cross-border welfare rights",dep.var.labels="Opposed to cross-border welfare rights",font.size="footnotesize",label="regtab1",column.sep.width="5pt",covariate.labels=c("Intercept","Gender (f)","Age","Education (some uni.)","Economic conservatism (EC)","Children stay","Ethnic prejudice (EP)","Bulgarian","No. children (NC)","EP*Bulgarian","EC*Bulgarian","EP*NC","EC*NC"),omit.stat=c("f"))
install.packages("systemfit")
system<-list(eq1=m09f,eq2=m10f)
systemfit(system,method="SUR",data=gd)
require(systemfit)
systemfit(system,method="SUR",data=gd)
summary(sur<-systemfit(system,method="SUR",data=gd))
setwd("/Users/frederikhjorth/Google Drive/InProgress/Gothenburg") #mac
#####################################
# PLOTS
#####################################
require(ggplot2)
t90<-1.65
t95<-1.96
#what are reasonable values for prejudice?
summary(gd$prej)
loprej<-quantile(gd$prej,.1,na.rm=T)
avgprej<-mean(gd$prej,na.rm=T)
hiprej<-quantile(gd$prej,.9,na.rm=T)
summary(gd$eid)
loeid<-quantile(gd$eid,.1,na.rm=T)
avgeid<-mean(gd$eid,na.rm=T)
hieid<-quantile(gd$eid,.9,na.rm=T)
table(gd$edulvl)
summary(gd$edulvl)
#plot effects of prej, eid, edu
preddf08<-as.data.frame(rbind(expand.grid(edulvl=seq(from=0,to=1,by=.125),eid=.36,prej=avgprej,female=0,age2013=48,bulg01=0,nkids=2,stayhome=0,indep="edulvl"),expand.grid(edulvl=.875,eid=seq(from=0,to=1,by=.1),prej=avgprej,female=0,age2013=48,bulg01=0,nkids=2,stayhome=0,indep="eid"),expand.grid(edulvl=.875,eid=.36,prej=seq(from=0,to=1,by=.1),female=0,age2013=48,bulg01=0,stayhome=0,nkids=2,indep="prej")))
preddf08$fit<-predict(m08,newdata=data.frame(preddf08),se.fit=T)$fit
preddf08$lwr<-predict(m08,newdata=data.frame(preddf08),se.fit=T)$fit-t95*predict(m08,newdata=data.frame(preddf08),se.fit=T)$se.fit
preddf08$upr<-predict(m08,newdata=data.frame(preddf08),se.fit=T)$fit+t95*predict(m08,newdata=data.frame(preddf08),se.fit=T)$se.fit
#preddf08<-preddf08[,c(1:3,8:11)]
str(preddf08)
preddf08$indepval<-NA
preddf08$indepval[preddf08$indep=="edulvl"]<-preddf08$edulvl[preddf08$indep=="edulvl"]
preddf08$indepval[preddf08$indep=="eid"]<-preddf08$eid[preddf08$indep=="eid"]
preddf08$indepval[preddf08$indep=="prej"]<-preddf08$prej[preddf08$indep=="prej"]
levels(preddf08$indep)<-c("Education (some uni.)", "Econ. conservatism","Ethnic prejudice")
pdf(file="indeps.pdf",height=4)
ggplot(preddf08,aes(x=indepval,y=fit)) +
geom_line(colour="#1f78b4") +
facet_grid(.~indep) +
geom_ribbon(aes(x=indepval,ymin=lwr,ymax=upr,width=.05),alpha=.1) +
geom_rug(position="jitter") +
ylab("Opposition to cross-border welfare rights") +
xlab("") +
theme_bw() +
theme(legend.position="bottom")
dev.off()
#plot interaction with bulgarian
require(effects)
preddf11a<-as.data.frame(effect("prej*bulg01",m11,list(prej=seq(from=0,to=1,by=.1),bulg01=c(0,1))))
preddf11a$var<-"prej"
preddf11b<-as.data.frame(effect("eid*bulg01",m12,list(prej=seq(from=0,to=1,by=.1),bulg01=c(0,1))))
preddf11b$var<-"eid"
names(preddf11a)[1]<-names(preddf11b)[1]<-"value"
preddf11<-as.data.frame(rbind(preddf11a,preddf11b))
preddf11$var<-factor(preddf11$var,labels=c("Economic conservatism","Ethnic prejudice"))
pdf(file="bulgint.pdf",height=5)
ggplot(preddf11,aes(x=value,y=fit,group=bulg01)) +
geom_line(aes(colour=factor(bulg01))) +
geom_ribbon(aes(x=value,ymin=lower,ymax=upper,width=.05),alpha=.1) +
geom_rug(position="jitter",alpha=.5) +
facet_grid(.~var) +
xlab("") +
ylab("Opposition to cross-border welfare rights") +
theme_bw() +
guides(colour=guide_legend(title="Recipient nationality")) +
scale_colour_brewer(palette="Paired",labels=c("Dutch","Bulgarian")) +
theme(legend.position="bottom") +
theme(legend.key = element_blank())
dev.off()
#plot prej:nkids interaction
preddf09<-expand.grid(bulg01=0:1,nkids=1:5,eid=avgeid,prej=c(loprej,avgprej,hiprej),female=0,age2013=48,edulvl=.875,stayhome=0)
preddf09$fit<-predict(m09,newdata=data.frame(preddf09),se.fit=T)$fit
preddf09$lwr<-predict(m09,newdata=data.frame(preddf09),se.fit=T)$fit-t95*predict(m09,newdata=data.frame(preddf09),se.fit=T)$se.fit
preddf09$upr<-predict(m09,newdata=data.frame(preddf09),se.fit=T)$fit+t95*predict(m09,newdata=data.frame(preddf09),se.fit=T)$se.fit
preddf09
#plot prej:nkids interaction
preddf10<-expand.grid(bulg01=0:1,nkids=1:5,eid=c(loeid,avgeid,hieid),prej=avgprej,female=0,age2013=48,edulvl=.875,stayhome=0)
preddf10$fit<-predict(m10,newdata=data.frame(preddf10),se.fit=T)$fit
preddf10$lwr<-predict(m10,newdata=data.frame(preddf10),se.fit=T)$fit-t95*predict(m10,newdata=data.frame(preddf10),se.fit=T)$se.fit
preddf10$upr<-predict(m10,newdata=data.frame(preddf10),se.fit=T)$fit+t95*predict(m10,newdata=data.frame(preddf10),se.fit=T)$se.fit
preddf10
#factor levels for prejudice
preddf09$level<-factor(as.character(preddf09$prej),labels=c("Low","Avg.","High"))
preddf09$var<-as.factor("Ethnic prejudice")
preddf10$level<-factor(as.character(preddf10$eid),labels=c("Low","Avg.","High"))
preddf10$var<-as.factor("Economic conservatism")
#interactions of both prej and eid
preddf0910<-as.data.frame(rbind(preddf09,preddf10))
pdf(file="prejeidnatkids.pdf",height=5)
ggplot(preddf0910,aes(x=nkids,y=fit,group=bulg01,colour=factor(bulg01))) +
geom_point() +
geom_errorbar(aes(x=nkids,ymin=lwr,ymax=upr,width=.1)) +
facet_grid(var~level) +
xlab("Number of kids") +
ylab("Opposition to cross-border welfare rights") +
theme_bw() +
guides(colour=guide_legend(title="Recipient nationality")) +
scale_colour_brewer(palette="Paired",labels=c("Dutch","Bulgarian")) +
theme(legend.position="bottom") +
theme(legend.key = element_blank())
dev.off()
setwd("~/Google Drive/InProgress/Gothenburg")
setwd("~/Google Drive/InProgress/Gothenburg") #mac
#####################################
# PLOTS
#####################################
require(ggplot2)
t90<-1.65
t95<-1.96
#what are reasonable values for prejudice?
summary(gd$prej)
loprej<-quantile(gd$prej,.1,na.rm=T)
avgprej<-mean(gd$prej,na.rm=T)
hiprej<-quantile(gd$prej,.9,na.rm=T)
summary(gd$eid)
loeid<-quantile(gd$eid,.1,na.rm=T)
avgeid<-mean(gd$eid,na.rm=T)
hieid<-quantile(gd$eid,.9,na.rm=T)
table(gd$edulvl)
summary(gd$edulvl)
#plot effects of prej, eid, edu
preddf08<-as.data.frame(rbind(expand.grid(edulvl=seq(from=0,to=1,by=.125),eid=.36,prej=avgprej,female=0,age2013=48,bulg01=0,nkids=2,stayhome=0,indep="edulvl"),expand.grid(edulvl=.875,eid=seq(from=0,to=1,by=.1),prej=avgprej,female=0,age2013=48,bulg01=0,nkids=2,stayhome=0,indep="eid"),expand.grid(edulvl=.875,eid=.36,prej=seq(from=0,to=1,by=.1),female=0,age2013=48,bulg01=0,stayhome=0,nkids=2,indep="prej")))
preddf08$fit<-predict(m08,newdata=data.frame(preddf08),se.fit=T)$fit
preddf08$lwr<-predict(m08,newdata=data.frame(preddf08),se.fit=T)$fit-t95*predict(m08,newdata=data.frame(preddf08),se.fit=T)$se.fit
preddf08$upr<-predict(m08,newdata=data.frame(preddf08),se.fit=T)$fit+t95*predict(m08,newdata=data.frame(preddf08),se.fit=T)$se.fit
#preddf08<-preddf08[,c(1:3,8:11)]
str(preddf08)
preddf08$indepval<-NA
preddf08$indepval[preddf08$indep=="edulvl"]<-preddf08$edulvl[preddf08$indep=="edulvl"]
preddf08$indepval[preddf08$indep=="eid"]<-preddf08$eid[preddf08$indep=="eid"]
preddf08$indepval[preddf08$indep=="prej"]<-preddf08$prej[preddf08$indep=="prej"]
levels(preddf08$indep)<-c("Education (some uni.)", "Econ. conservatism","Ethnic prejudice")
pdf(file="indeps.pdf",height=4)
ggplot(preddf08,aes(x=indepval,y=fit)) +
geom_line(colour="#1f78b4") +
facet_grid(.~indep) +
geom_ribbon(aes(x=indepval,ymin=lwr,ymax=upr,width=.05),alpha=.1) +
geom_rug(position="jitter") +
ylab("Opposition to cross-border welfare rights") +
xlab("") +
theme_bw() +
theme(legend.position="bottom")
dev.off()
#plot interaction with bulgarian
require(effects)
preddf11a<-as.data.frame(effect("prej*bulg01",m11,list(prej=seq(from=0,to=1,by=.1),bulg01=c(0,1))))
preddf11a$var<-"prej"
preddf11b<-as.data.frame(effect("eid*bulg01",m12,list(prej=seq(from=0,to=1,by=.1),bulg01=c(0,1))))
preddf11b$var<-"eid"
names(preddf11a)[1]<-names(preddf11b)[1]<-"value"
preddf11<-as.data.frame(rbind(preddf11a,preddf11b))
preddf11$var<-factor(preddf11$var,labels=c("Economic conservatism","Ethnic prejudice"))
pdf(file="bulgint.pdf",height=5)
ggplot(preddf11,aes(x=value,y=fit,group=bulg01)) +
geom_line(aes(colour=factor(bulg01))) +
geom_ribbon(aes(x=value,ymin=lower,ymax=upper,width=.05),alpha=.1) +
geom_rug(position="jitter",alpha=.5) +
facet_grid(.~var) +
xlab("") +
ylab("Opposition to cross-border welfare rights") +
theme_bw() +
guides(colour=guide_legend(title="Recipient nationality")) +
scale_colour_brewer(palette="Paired",labels=c("Dutch","Bulgarian")) +
theme(legend.position="bottom") +
theme(legend.key = element_blank())
dev.off()
#plot prej:nkids interaction
preddf09<-expand.grid(bulg01=0:1,nkids=1:5,eid=avgeid,prej=c(loprej,avgprej,hiprej),female=0,age2013=48,edulvl=.875,stayhome=0)
preddf09$fit<-predict(m09,newdata=data.frame(preddf09),se.fit=T)$fit
preddf09$lwr<-predict(m09,newdata=data.frame(preddf09),se.fit=T)$fit-t95*predict(m09,newdata=data.frame(preddf09),se.fit=T)$se.fit
preddf09$upr<-predict(m09,newdata=data.frame(preddf09),se.fit=T)$fit+t95*predict(m09,newdata=data.frame(preddf09),se.fit=T)$se.fit
preddf09
#plot prej:nkids interaction
preddf10<-expand.grid(bulg01=0:1,nkids=1:5,eid=c(loeid,avgeid,hieid),prej=avgprej,female=0,age2013=48,edulvl=.875,stayhome=0)
preddf10$fit<-predict(m10,newdata=data.frame(preddf10),se.fit=T)$fit
preddf10$lwr<-predict(m10,newdata=data.frame(preddf10),se.fit=T)$fit-t95*predict(m10,newdata=data.frame(preddf10),se.fit=T)$se.fit
preddf10$upr<-predict(m10,newdata=data.frame(preddf10),se.fit=T)$fit+t95*predict(m10,newdata=data.frame(preddf10),se.fit=T)$se.fit
preddf10
#factor levels for prejudice
preddf09$level<-factor(as.character(preddf09$prej),labels=c("Low","Avg.","High"))
preddf09$var<-as.factor("Ethnic prejudice")
preddf10$level<-factor(as.character(preddf10$eid),labels=c("Low","Avg.","High"))
preddf10$var<-as.factor("Economic conservatism")
#interactions of both prej and eid
preddf0910<-as.data.frame(rbind(preddf09,preddf10))
pdf(file="prejeidnatkids.pdf",height=5)
ggplot(preddf0910,aes(x=nkids,y=fit,group=bulg01,colour=factor(bulg01))) +
geom_point() +
geom_errorbar(aes(x=nkids,ymin=lwr,ymax=upr,width=.1)) +
facet_grid(var~level) +
xlab("Number of kids") +
ylab("Opposition to cross-border welfare rights") +
theme_bw() +
guides(colour=guide_legend(title="Recipient nationality")) +
scale_colour_brewer(palette="Paired",labels=c("Dutch","Bulgarian")) +
theme(legend.position="bottom") +
theme(legend.key = element_blank())
dev.off()
#get dotplot of cultural support for immigration
ess6<-read.dta(file="../../../Data/ESS6e02.stata/ESS6e02.dta")
ess6$cultenrich<-ifelse(as.numeric(ess6$imueclt)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
cntry
require(dplyr)
immsum<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(cultenrich,na.rm=T),se=sd(cultenrich,na.rm=T)/sqrt(length(cultenrich)))
rm(ess6)
immsum$lwr95<-immsum$avg-t95*immsum$se
immsum$lwr90<-immsum$avg-t90*immsum$se
immsum$upr90<-immsum$avg+t90*immsum$se
immsum$upr95<-immsum$avg+t95*immsum$se
immsum$cntry<-reorder(immsum$cntry,immsum$avg)
ess6<-read.dta(file="/Users/frederikhjorth/Data/ESS/ESS6e02.dta")
ess6$cultenrich<-ifelse(as.numeric(ess6$imueclt)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
install.packages("dplyr")
require(dplyr)
immsum<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(cultenrich,na.rm=T),se=sd(cultenrich,na.rm=T)/sqrt(length(cultenrich)))
rm(ess6)
immsum$lwr95<-immsum$avg-t95*immsum$se
immsum$lwr90<-immsum$avg-t90*immsum$se
immsum$upr90<-immsum$avg+t90*immsum$se
immsum$upr95<-immsum$avg+t95*immsum$se
immsum$cntry<-reorder(immsum$cntry,immsum$avg)
ggplot(subset(immsum,!(cntry %in% c("AL","IL","NO","RU","XK","UA","CH","IS"))),aes(x=avg,y=cntry,colour=factor(cntry=="SE"))) +
geom_point() +
geom_errorbarh(aes(xmin=lwr95,xmax=upr95),size=.5,width=.01,height=.5) +
#  geom_errorbarh(aes(xmin=lwr90,xmax=upr90),size=.6,height=.01) +
theme_bw() +
theme(legend.position="none") +
xlab("Avg. agreement 'cultural life is enriched by people coming to live here from other countries'") +
scale_colour_brewer(palette="Paired") +
#  scale_colour_manual(values=c("light blue","dark blue")) +
ylab("") +
theme(axis.text.y = element_text(colour="black"))
setwd("~/Google Drive/InProgress/Gothenburg") #mac
pdf(file="essplot.pdf",height=4,width=8)
ggplot(subset(immsum,!(cntry %in% c("AL","IL","NO","RU","XK","UA","CH","IS"))),aes(x=avg,y=cntry,colour=factor(cntry=="SE"))) +
geom_point() +
geom_errorbarh(aes(xmin=lwr95,xmax=upr95),size=.5,width=.01,height=.5) +
#  geom_errorbarh(aes(xmin=lwr90,xmax=upr90),size=.6,height=.01) +
theme_bw() +
theme(legend.position="none") +
xlab("Avg. agreement 'cultural life is enriched by people coming to live here from other countries'") +
scale_colour_brewer(palette="Paired") +
#  scale_colour_manual(values=c("light blue","dark blue")) +
ylab("") +
theme(axis.text.y = element_text(colour="black"))
dev.off()
ggplot(gd,aes(x=eid,y=prej)) +
geom_point(position="jitter",alpha=.5) +
theme_bw()
summary(lm(prej~eid,data=gd))
cor.test(gd$prej,gd$eid)
ggplot(gd,aes(x=eid,y=prej)) +
geom_point(position="jitter",alpha=.5) +
theme_bw() +
xlab("Economic conservatism") +
ylab("Ethnic prejudice")
ggplot(gd,aes(x=eid,y=prej)) +
geom_point(position="jitter",alpha=.5) +
geom_smooth(method="lm") +
theme_bw() +
xlab("Economic conservatism") +
ylab("Ethnic prejudice")
#for the appendix: how strongly are eid and prej correlated?
pdf(file="eidprejbivarplot.pdf")
ggplot(gd,aes(x=eid,y=prej)) +
geom_point(position="jitter",alpha=.5) +
#  geom_smooth(method="lm") +
theme_bw() +
xlab("Economic conservatism") +
ylab("Ethnic prejudice")
dev.off()
table(gd$prej>median(gd$prej))
table(gd$prej>median(gd$prej,na.rm=T))
table(gd$prej>median(gd$prej,na.rm=T),gd$eid>median(gd$eid,na.rm=T))
table(gd$prej>median(gd$prej,na.rm=T),gd$eid>median(gd$eid,na.rm=T))[2,]
table(gd$prej>median(gd$prej,na.rm=T),gd$eid>median(gd$eid,na.rm=T))[2,1]
sum(table(gd$prej>median(gd$prej,na.rm=T),gd$eid>median(gd$eid,na.rm=T))[2,])
table(gd$prej>median(gd$prej,na.rm=T),gd$eid>median(gd$eid,na.rm=T))[2,1]/sum(table(gd$prej>median(gd$prej,na.rm=T),gd$eid>median(gd$eid,na.rm=T))[2,])
table(gd$prej>median(gd$prej,na.rm=T),gd$eid>median(gd$eid,na.rm=T))[2,2]/sum(table(gd$prej>median(gd$prej,na.rm=T),gd$eid>median(gd$eid,na.rm=T))[2,])
require(RCurl)
lp<-read.csv(getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/loekkepoll3.csv"))
lp<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/loekkepoll3.csv"))
View(lp)
rm(lp)
lp<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/loekkepoll3.csv"))
View(lp)
lp$supopp01<-NA
View(lp)
lp$supopp01[lp$support==1]<-1
lp$supopp01[lp$oppose==1]<-0
View(lp)
summary(glm(supopp01~taxbase,data=lp,family="binomial"))
install.packages("separationplot")
summary(mod1<-glm(supopp01~taxbase,data=lp,family="binomial"))
?glm
mod1$fitted.values
ld$fit<-mod1$fitted.values
lp$fit<-mod1$fitted.values
mod1$y
require(separationplot)
separationplot(pred=mod1$fitted.values,actual=mod1$y)
lp$oppose01<-ifelse(lp$oppose==1,1,0)
summary(mod1<-glm(oppose01~taxbase,data=lp,family="binomial"))
View(lp)
lp$oppose01<-0
lp$oppose01<-ifelse(lp$oppose==1,1,0)
summary(mod1<-glm(supopp01~taxbase,data=lp,family="binomial"))
summary(mod1<-glm(oppose01~taxbase,data=lp,family="binomial"))
View(lp)
require(RCurl)
lp<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/loekkepoll3.csv"))
lp$supopp01<-NA
#create support/oppose variable
lp$supopp01[lp$support==1]<-1
lp$supopp01[lp$oppose==1]<-0
#binary opposition
lp$oppose01<-0
lp$oppose01<-ifelse(lp$oppose==1,1,0)
View(lp)
str(lp)
lp$oppose01<-0
str(lp)
lp$oppose01<-ifelse(lp$oppose==1,1,lp$oppose01)
str(lp)
require(RCurl)
lp<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/loekkepoll3.csv"))
lp$supopp01<-NA
#create support/oppose variable
lp$supopp01[lp$support==1]<-1
lp$supopp01[lp$oppose==1]<-0
#binary opposition
str(lp)
lp$oppose01<-0
lp$oppose01[lp$oppose==1]<-1
str(lp)
summary(mod1<-glm(supopp01~taxbase,data=lp,family="binomial"))
summary(mod1<-glm(oppose01~taxbase,data=lp,family="binomial"))
lp$oppdksup<-0
View(lp)
lp$oppdksup[lp$oppose==1]<- -1
lp$oppdksup[lp$support==1]<- 1
View(lp)
summary(mod3<-lm(oppdksup~taxbase,data=lp))
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(position="jitter")
summary(mod3<-lm(oppdksup~log(taxbase),data=lp))
ggplot(lp,aes(x=log(taxbase),y=oppdksup)) +
geom_point(position="jitter")
ggplot(lp,aes(x=log(taxbase),y=oppdksup,color=factor(oppdksup))) +
geom_point(position="jitter")
ggplot(lp,aes(x=taxbase,y=oppdksup,color=factor(oppdksup))) +
geom_point(position="jitter")
ggplot(lp,aes(x=taxbase,y=oppdksup,color=factor(oppdksup))) +
geom_point(position="jitter") +
theme_bw()
View(lp)
density<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/density.csv"))
View(density)
View(lp)
lp<-merge(lp,density,by="knr",all.x=T)
View(lp)
summary(mod3<-lm(oppdksup~density,data=lp))
ggplot(lp,aes(x=density,y=oppdksup)) +
geom_point()
summary(mod3<-lm(oppose01~density,data=lp))
summary(mod3<-glm(oppose01~density,data=lp,family="binomial"))
summary(mod3<-lm(oppdksup~taxbase+density,data=lp))
summary(mod3<-lm(oppdksup~taxbase+log(density),data=lp))
summary(mod3<-lm(oppdksup~log(density),data=lp))
summary(mod3<-lm(oppose01~log(density),data=lp))
summary(mod3<-lm(oppdksup~taxbase+density,data=lp))
summary(mod3<-lm(oppdksup~taxbase,data=lp))
summary(mod4<-lm(oppdksup~taxbase+density,data=lp))
summary(mod3<-lm(oppdksup~taxbase,data=lp))
ggplot(lp,aes(x=taxbase,y=oppdksup,color=factor(oppdksup))) +
geom_point()
ggplot(lp,aes(x=taxbase,y=oppdksup,color=factor(oppdksup))) +
geom_point() +
geom_smooth(method="lm") +
theme_bw()
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(color=factor(oppdksup)) +
geom_smooth(method="lm") +
theme_bw()
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm") +
theme_bw()
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw()
summary(mod2<-glm(oppose01~taxbase,data=lp,family="binomial"))
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw()
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("red","green","yellow"))
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green"))
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme_legend(position="none")
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none")
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="bottom")
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none") +
xlab("Beskatningsgrundlag") +
ylab("Støtte til Løkke (-1=nej, +1=ja, 0=ved ikke")
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none") +
xlab("Beskatningsgrundlag") +
ylab("Støtte til Løkke (-1='nej', +1='ja', 0='ved ikke')")
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none") +
xlab("Beskatningsgrundlag") +
ylab("Støtte til Løkke (-1='nej', 0='ved ikke', +1='ja')")
setwd("~/GitHub/loekkepoll")
setwd("~/GitHub/loekkepoll")
pdf(file="taxplot.pdf")
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(aes(color=factor(oppdksup))) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none") +
xlab("Beskatningsgrundlag") +
ylab("Støtte til Løkke (-1='nej', 0='ved ikke', +1='ja')")
dev.off()
