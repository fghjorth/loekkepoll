gd$oppose<-(as.numeric(gd$s2_q44)-1)/4
table(gd$s2_q45)
table(as.numeric(gd$s2_q45))
gd$cutwelf<-(as.numeric(gd$s2_q45)-5)*-25
#kids
table(gdlabs$s2gr2)
table(as.numeric(gd$s2gr2))
gd$nkids<-as.numeric(gd$s2gr2)
#kids stay home
table(gdlabs$s2gr3)
table(as.numeric(gd$s2gr3))
gd$stayhome<-(as.numeric(gd$s2gr3)-1)
#prejudice
table(gdlabs$prejudice1)
table(as.numeric(gd$prejudice1))
require(psy)
prejualpha<-cronbach(data.frame(cbind(as.numeric(gd$prejudice1),as.numeric(gd$prejudice2),-as.numeric(gd$prejudice3),-as.numeric(gd$prejudice4),-as.numeric(gd$prejudice5),-as.numeric(gd$prejudice6))))$alpha
gd$prej<-((as.numeric(gd$prejudice1)+as.numeric(gd$prejudice2)-as.numeric(gd$prejudice3)-as.numeric(gd$prejudice4)-as.numeric(gd$prejudice5)-as.numeric(gd$prejudice6))-6)*(-1/24)
hist(gd$prej)
sd(gd$prej,na.rm=T)
#economic ideology
table(gd$s2_q32_5)
table(as.numeric(gd$s2_q32_1))
gd$eid1<-ifelse(as.numeric(gd$s2_q32_1)<6,(as.numeric(gd$s2_q32_1)-5)/-4)
gd$eid2<-ifelse(as.numeric(gd$s2_q34_1)<6,(as.numeric(gd$s2_q34_1)-5)/-4)
gd$eid3<-ifelse(as.numeric(gd$s2_q34_4)<6,(as.numeric(gd$s2_q34_4)-1)/4)
gd$eid4<-ifelse(as.numeric(gd$s2_q34_5)<6,(as.numeric(gd$s2_q34_5)-5)/-4)
gd$eid5<-ifelse(as.numeric(gd$s2_q32_5)<6,(as.numeric(gd$s2_q32_5)-1)/4)
require(psych)
alpha(data.frame(a=gd$eid1,b=gd$eid2,c=gd$eid3,d=gd$eid4,e=gd$eid5)) #this gives a nice alpha
gd$eid<-(gd$eid1+gd$eid2+gd$eid3+gd$eid4+gd$eid5)/5
hist(gd$eid)
#demographics
table(gdlabs$sex)
table(gd$sex)
gd$female<-(as.numeric(gd$sex))
table(gdlabs$edu)
table(gd$age2013)
table(as.numeric(gd$edu))
gd$edulvl<-(as.numeric(gd$edu)-1)/8
gd$someuni<-ifelse(as.numeric(gd$edu)>6,1,0)
table(gdlabs$lmsit)
table(gd$lmsit)
gd$onlabmkt<-ifelse(gd$lmsit==1,1,0)
table(gdlabs$income_own_m)
gd$income<-ifelse(gd$income_own_m<14,(gd$income_own_m-1)/12,NA)
#stereotype congruence
gd$congruence<-NA
gd$congruence[gd$bulg01==1 & gd$nkids>2]<-1
gd$congruence[gd$bulg01==1 & gd$nkids<3]<-0
gd$congruence[gd$bulg01==0 & gd$nkids<3]<-1
gd$congruence[gd$bulg01==0 & gd$nkids>2]<-0
table(gd$congruence)
#reaction time to first q about experimental probe
gd$react1<-ifelse(gd$t_s2_q46_1>0 & gd$t_s2_q46_1<100,gd$t_s2_q46_1,NA)
hist(gd$react1)
gd$react2<-rank(gd$t_s2_q46_1)
gd$react3<-rank(gd$react1)
gd$react4<-log(gd$react1)
#how many does the trimming lose?
summary(gd$t_s2_q46_1)
summary(gd$react1)
#overview of data
str(gd)
#move constructed vars to the front to make it easier to inspect data
gd<-gd[,c(59:ncol(gd),1:58)]
#####################################
# REGS
#####################################
#regs
summary(m06<-lm(oppose~female+age2013+edulvl,data=gd))
summary(m07<-lm(oppose~female+age2013+edulvl+prej+eid,data=gd))
summary(m08<-lm(oppose~female+age2013+edulvl+prej+eid+stayhome+bulg01+nkids,data=gd))
summary(m08a<-lm(oppose~female+age2013+edulvl+prej+stayhome+bulg01+nkids,data=gd))
summary(m08b<-lm(oppose~female+age2013+edulvl+eid+stayhome+bulg01+nkids,data=gd))
summary(m08b<-lm(oppose~female+age2013+edulvl*bulg01+prej+eid+stayhome+nkids,data=gd)) #just to be clear - no different skill-based reaction to nationality
require(stargazer)
?stargazer
regtab0<-stargazer(m06,m07,m08,style="apsr",title="Models of opposition to cross-border welfare rights",intercept.bottom=F,digits=3,dep.var.caption="Opposed to cross-border welfare rights",dep.var.labels="Opposed to cross-border welfare rights",font.size="footnotesize",label="regtab0",column.sep.width="5pt",covariate.labels=c("Intercept","Gender (f)","Age","Education (some uni.)","Ethnic prejudice (EP)","Economic conservatism (EC)","Children stay","Bulgarian","No. children (NC)"),omit.stat=c("f"))
writeLines(regtab0,con="regtab0.txt")
regtab0ab<-stargazer(m08,m08a,m08b,style="apsr",title="Models of opposition to cross-border welfare rights",intercept.bottom=F,digits=3,dep.var.caption="Opposed to cross-border welfare rights",dep.var.labels="Opposed to cross-border welfare rights",font.size="footnotesize",label="regtab0",column.sep.width="5pt",covariate.labels=c("Intercept","Gender (f)","Age","Education (some uni.)","Ethnic prejudice (EP)","Economic conservatism (EC)","Children stay","Bulgarian","No. children (NC)"),omit.stat=c("f"))
writeLines(regtab0ab,con="regtab0ab.txt")
#regs
summary(m06<-lm(oppose~female+age2013+edulvl,data=gd))
summary(m07<-lm(oppose~female+age2013+edulvl+prej+eid,data=gd))
summary(m08<-lm(oppose~female+age2013+edulvl+prej+eid+stayhome+bulg01+nkids,data=gd))
summary(m08a<-lm(oppose~female+age2013+edulvl+prej+stayhome+bulg01+nkids,data=gd))
summary(m08b<-lm(oppose~female+age2013+edulvl+eid+stayhome+bulg01+nkids,data=gd))
regtab0ab<-stargazer(m08,m08a,m08b,style="apsr",title="Models of opposition to cross-border welfare rights",intercept.bottom=F,digits=3,dep.var.caption="Opposed to cross-border welfare rights",dep.var.labels="Opposed to cross-border welfare rights",font.size="footnotesize",label="regtab0",column.sep.width="5pt",covariate.labels=c("Intercept","Gender (f)","Age","Education (some uni.)","Ethnic prejudice (EP)","Economic conservatism (EC)","Children stay","Bulgarian","No. children (NC)"),omit.stat=c("f"))
writeLines(regtab0ab,con="regtab0ab.txt")
regtab0ab<-stargazer(m08,m08a,m08b,style="apsr",title="Models of opposition to cross-border welfare rights",intercept.bottom=F,digits=3,dep.var.caption="Opposed to cross-border welfare rights",dep.var.labels="Opposed to cross-border welfare rights",font.size="footnotesize",label="regtab0ab",column.sep.width="5pt",covariate.labels=c("Intercept","Gender (f)","Age","Education (some uni.)","Ethnic prejudice (EP)","Economic conservatism (EC)","Children stay","Bulgarian","No. children (NC)"),omit.stat=c("f"))
writeLines(regtab0ab,con="regtab0ab.txt")
require(RCurl)
lp<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/loekkepoll3.csv"))
density<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/density.csv"))
lp<-merge(lp,density,by="knr",all.x=T)
lp$supopp01<-NA
#create support/oppose variable
lp$supopp01[lp$support==1]<-1
lp$supopp01[lp$oppose==1]<-0
#binary opposition
str(lp)
lp$oppose01<-0
lp$oppose01[lp$oppose==1]<-1
str(lp)
#linear variable
lp$oppdksup<-0
lp$oppdksup[lp$oppose==1]<- -1
lp$oppdksup[lp$support==1]<- 1
#fit models with tax base
summary(mod1<-glm(supopp01~taxbase,data=lp,family="binomial"))
summary(mod2<-glm(oppose01~taxbase,data=lp,family="binomial"))
summary(mod3<-lm(oppdksup~taxbase,data=lp))
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(position=position_jitter(w = 0.1, h = 0.1),aes(color=factor(oppdksup)),alpha=.8) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none") +
xlab("Beskatningsgrundlag pr. indb.") +
ylab("Støtte til Løkke (-1='nej', 0='ved ikke', +1='ja')")
require(ggplot2)
setwd("~/GitHub/loekkepoll")
pdf(file="taxplot.pdf")
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(position=position_jitter(w = 0.1, h = 0.1),aes(color=factor(oppdksup)),alpha=.8) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none") +
xlab("Beskatningsgrundlag pr. indb.") +
ylab("Støtte til Løkke (-1='nej', 0='ved ikke', +1='ja')")
dev.off()
689/425
#get dotplot of cultural support for immigration
ess6<-read.dta(file="/Users/frederikhjorth/Data/ESS/ESS6e02.dta")
ess6$cultenrich<-ifelse(as.numeric(ess6$imueclt)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
cntry
ess6$cultenrich<-ifelse(as.numeric(ess6$imueclt)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
ess6$goodecon<-ifelse(as.numeric(ess6$imbegeco)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
ess6$betplace<-ifelse(as.numeric(ess6$imwbcnt)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
ess6$goodecon<-ifelse(as.numeric(ess6$imbgeco)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
require(dplyr)
immsum<-ess6 %.%
group_by(cntry) %.%
summarise(cavg=mean(cultenrich,na.rm=T),cse=sd(cultenrich,na.rm=T)/sqrt(length(cultenrich)),gavg=mean(goodecon,na.rm=T),gse=sd(goodecon,na.rm=T)/sqrt(length(goodecon)),bavg=mean(betplace,na.rm=T),bse=sd(betplace,na.rm=T)/sqrt(length(betplace)))
View(immsum)
View(immsum)
rm(ess6)
require(reshape2)
?melt
View(immsum)
melt(immsum,id.vars="cntry")
melt(immsum,id.vars="cntry",measure.vars=c("cavg"))
immsumc<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(cultenrich,na.rm=T),se=sd(cultenrich,na.rm=T)/sqrt(length(cultenrich),var="cultenrich"))
#get dotplot of cultural support for immigration
ess6<-read.dta(file="/Users/frederikhjorth/Data/ESS/ESS6e02.dta")
ess6$cultenrich<-ifelse(as.numeric(ess6$imueclt)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
ess6$goodecon<-ifelse(as.numeric(ess6$imbgeco)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
ess6$betplace<-ifelse(as.numeric(ess6$imwbcnt)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
require(dplyr)
immsumc<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(cultenrich,na.rm=T),se=sd(cultenrich,na.rm=T)/sqrt(length(cultenrich),var="cultenrich"))
immsumc<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(cultenrich,na.rm=T),se=sd(cultenrich,na.rm=T)/sqrt(length(cultenrich)),var="cultenrich"))
immsumc<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(cultenrich,na.rm=T),se=sd(cultenrich,na.rm=T)/sqrt(length(cultenrich)),var="cultenrich")
View(immsumc)
require(dplyr)
immsumc<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(cultenrich,na.rm=T),se=sd(cultenrich,na.rm=T)/sqrt(length(cultenrich)),var="cultenrich")
immsumg<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(goodecon,na.rm=T),se=sd(goodecon,na.rm=T)/sqrt(length(goodecon)),var="goodecon")
immsumb<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(betplace,na.rm=T),se=sd(betplace,na.rm=T)/sqrt(length(betplace)),var="betplace")
rm(ess6)
immsum<-as.data.frame(rbind(immsumc,immsumg,immsumb))
immsum$lwr95<-immsum$avg-t95*immsum$se
immsum$lwr90<-immsum$avg-t90*immsum$se
immsum$upr90<-immsum$avg+t90*immsum$se
immsum$upr95<-immsum$avg+t95*immsum$se
immsum$cntry<-reorder(immsum$cntry,immsum$avg[immsum$var=="cultenrich"])
t90<-1.65
t95<-1.96
immsum$lwr95<-immsum$avg-t95*immsum$se
immsum$lwr90<-immsum$avg-t90*immsum$se
immsum$upr90<-immsum$avg+t90*immsum$se
immsum$upr95<-immsum$avg+t95*immsum$se
immsum$cntry<-reorder(immsum$cntry,immsum$avg[immsum$var=="cultenrich"])
ggplot(subset(immsum,!(cntry %in% c("AL","IL","NO","RU","XK","UA","CH","IS"))),aes(x=avg,y=cntry,colour=factor(cntry=="SE"))) +
geom_point() +
geom_errorbarh(aes(xmin=lwr95,xmax=upr95),size=.5,width=.01,height=.5) +
#  geom_errorbarh(aes(xmin=lwr90,xmax=upr90),size=.6,height=.01) +
theme_bw() +
theme(legend.position="none") +
facet_grid(.~var)
xlab("Avg. agreement 'cultural life is enriched by people coming to live here from other countries'") +
scale_colour_brewer(palette="Paired") +
#  scale_colour_manual(values=c("light blue","dark blue")) +
ylab("") +
theme(axis.text.y = element_text(colour="black"))
#get dotplot of cultural support for immigration
ess6<-read.dta(file="/Users/frederikhjorth/Data/ESS/ESS6e02.dta")
ess6$cultenrich<-ifelse(as.numeric(ess6$imueclt)<12,(as.numeric(ess6$imueclt)-1)/10,NA)
ess6$goodecon<-ifelse(as.numeric(ess6$imbgeco)<12,(as.numeric(ess6$imbgeco)-1)/10,NA)
ess6$betplace<-ifelse(as.numeric(ess6$imwbcnt)<12,(as.numeric(ess6$imwbcnt)-1)/10,NA)
require(dplyr)
immsumc<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(cultenrich,na.rm=T),se=sd(cultenrich,na.rm=T)/sqrt(length(cultenrich)),var="cultenrich")
immsumg<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(goodecon,na.rm=T),se=sd(goodecon,na.rm=T)/sqrt(length(goodecon)),var="goodecon")
immsumb<-ess6 %.%
group_by(cntry) %.%
summarise(avg=mean(betplace,na.rm=T),se=sd(betplace,na.rm=T)/sqrt(length(betplace)),var="betplace")
rm(ess6)
immsum<-as.data.frame(rbind(immsumc,immsumg,immsumb))
immsum$lwr95<-immsum$avg-t95*immsum$se
immsum$lwr90<-immsum$avg-t90*immsum$se
immsum$upr90<-immsum$avg+t90*immsum$se
immsum$upr95<-immsum$avg+t95*immsum$se
immsum$cntry<-reorder(immsum$cntry,immsum$avg[immsum$var=="cultenrich"])
ggplot(subset(immsum,!(cntry %in% c("AL","IL","NO","RU","XK","UA","CH","IS"))),aes(x=avg,y=cntry,colour=factor(cntry=="SE"))) +
geom_point() +
geom_errorbarh(aes(xmin=lwr95,xmax=upr95),size=.5,width=.01,height=.5) +
#  geom_errorbarh(aes(xmin=lwr90,xmax=upr90),size=.6,height=.01) +
theme_bw() +
theme(legend.position="none") +
facet_grid(.~var) +
xlab("Avg. agreement 'cultural life is enriched by people coming to live here from other countries'") +
scale_colour_brewer(palette="Paired") +
#  scale_colour_manual(values=c("light blue","dark blue")) +
ylab("") +
theme(axis.text.y = element_text(colour="black"))
View(immsum)
immsum$cntry<-reorder(immsum$cntry,immsum$avg)
ggplot(subset(immsum,!(cntry %in% c("AL","IL","NO","RU","XK","UA","CH","IS"))),aes(x=avg,y=cntry,colour=factor(cntry=="SE"))) +
geom_point() +
geom_errorbarh(aes(xmin=lwr95,xmax=upr95),size=.5,width=.01,height=.5) +
#  geom_errorbarh(aes(xmin=lwr90,xmax=upr90),size=.6,height=.01) +
theme_bw() +
theme(legend.position="none") +
facet_grid(.~var) +
xlab("Avg. agreement 'cultural life is enriched by people coming to live here from other countries'") +
scale_colour_brewer(palette="Paired") +
#  scale_colour_manual(values=c("light blue","dark blue")) +
ylab("") +
theme(axis.text.y = element_text(colour="black"))
levels(factor(immsum$var))
levels(immsum$var)
as.factor(immsum$var)
as.factor(immsum$var,levels=a:c)
as.factor(immsum$var,labels=a:c)
factor(immsum$var,levels=a:c)
factor(immsum$var,levels=c("a","b","c"))
factor(immsum$var,labels=c("a","b","c"))
factor(immsum$var)
factor(immsum$var,levels=c("a","b","c"))
factor(immsum$var,labels=c("a","b","c"))
immsum$var<-factor(immsum$var,labels=c("Make country better place","Enrich culture","Good for economy"))
ggplot(subset(immsum,!(cntry %in% c("AL","IL","NO","RU","XK","UA","CH","IS"))),aes(x=avg,y=cntry,colour=factor(cntry=="SE"))) +
geom_point() +
geom_errorbarh(aes(xmin=lwr95,xmax=upr95),size=.5,width=.01,height=.5) +
#  geom_errorbarh(aes(xmin=lwr90,xmax=upr90),size=.6,height=.01) +
theme_bw() +
theme(legend.position="none") +
facet_grid(.~var) +
xlab("Avg. agreement with statement about immigration") +
scale_colour_brewer(palette="Paired") +
#  scale_colour_manual(values=c("light blue","dark blue")) +
ylab("") +
theme(axis.text.y = element_text(colour="black"))
setwd("~/Google Drive/InProgress/Gothenburg") #mac
pdf(file="essplot.pdf",height=4,width=8)
ggplot(subset(immsum,!(cntry %in% c("AL","IL","NO","RU","XK","UA","CH","IS"))),aes(x=avg,y=cntry,colour=factor(cntry=="SE"))) +
geom_point() +
geom_errorbarh(aes(xmin=lwr95,xmax=upr95),size=.5,width=.01,height=.5) +
#  geom_errorbarh(aes(xmin=lwr90,xmax=upr90),size=.6,height=.01) +
theme_bw() +
theme(legend.position="none") +
facet_grid(.~var) +
xlab("Avg. agreement with statement about immigration") +
scale_colour_brewer(palette="Paired") +
#  scale_colour_manual(values=c("light blue","dark blue")) +
ylab("") +
theme(axis.text.y = element_text(colour="black"))
dev.off()
setwd("~/Google Drive/InProgress/Gothenburg") #mac
pdf(file="essplot.pdf",height=4,width=9)
ggplot(subset(immsum,!(cntry %in% c("AL","IL","NO","RU","XK","UA","CH","IS"))),aes(x=avg,y=cntry,colour=factor(cntry=="SE"))) +
geom_point() +
geom_errorbarh(aes(xmin=lwr95,xmax=upr95),size=.5,width=.01,height=.5) +
#  geom_errorbarh(aes(xmin=lwr90,xmax=upr90),size=.6,height=.01) +
theme_bw() +
theme(legend.position="none") +
facet_grid(.~var) +
xlab("Avg. agreement with statement about immigration") +
scale_colour_brewer(palette="Paired") +
#  scale_colour_manual(values=c("light blue","dark blue")) +
ylab("") +
theme(axis.text.y = element_text(colour="black"))
dev.off()
immsum$var<-factor(immsum$var,labels=c("Makes country better place","Enriches culture","Good for economy"))
factor(immsum$var)
setwd("~/Google Drive/InProgress/Gothenburg") #mac
pdf(file="essplot.pdf",height=4,width=9)
ggplot(subset(immsum,!(cntry %in% c("AL","IL","NO","RU","XK","UA","CH","IS"))),aes(x=avg,y=cntry,colour=factor(cntry=="SE"))) +
geom_point() +
geom_errorbarh(aes(xmin=lwr95,xmax=upr95),size=.5,width=.01,height=.5) +
#  geom_errorbarh(aes(xmin=lwr90,xmax=upr90),size=.6,height=.01) +
theme_bw() +
theme(legend.position="none") +
facet_grid(.~var) +
xlab("Avg. agreement with statement about immigration") +
scale_colour_brewer(palette="Paired") +
#  scale_colour_manual(values=c("light blue","dark blue")) +
ylab("") +
theme(axis.text.y = element_text(colour="black"))
dev.off()
summary(lp$taxbase)
lp[lp$taxbase==164400,]
View(lp[order(lp$taxbase),])
lp[lp$name=="Esbjerg",]
str(lp)
lp[as.character(lp$name)=="Esbjerg",]
as.character(lp$name)
lp[as.character(lp$name)=="Esbjerg Kommune",]
summary(lp$taxbase[lp$oppdksup==-1])
lp[lp$oppdksup==-1,]
dim(lp[lp$oppdksup==-1,])
summary(lp$taxbase)
View(lp[order(lp$taxbase,)])
View(lp[order(lp$taxbase),])
table(lp$oppdksup==-1)
table(lp$oppdksup==-1,lp$oppdksup>176800)
str(lp)
table(lp$oppdksup==-1,lp$taxbase>176800)
summary(lp$taxbase[lp$oppdksup==-1])
lp[lp$oppdksup==-1,]
table(lp$oppdksup==-1,lp$taxbase>176800)
prop.table(table(lp$oppdksup==-1,lp$taxbase>176800))
2/27
11/58
require(RCurl)
lp<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/loekkepoll3.csv"))
density<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/density.csv"))
lp<-merge(lp,density,by="knr",all.x=T)
lp$supopp01<-NA
#create support/oppose variable
lp$supopp01[lp$support==1]<-1
lp$supopp01[lp$oppose==1]<-0
#binary opposition
str(lp)
lp$oppose01<-0
lp$oppose01[lp$oppose==1]<-1
str(lp)
#linear variable
lp$oppdksup<-0
lp$oppdksup[lp$oppose==1]<- -1
lp$oppdksup[lp$support==1]<- 1
#summary stats
str(lp)
summary(lp$taxbase)
as.character(lp$name)
View(lp[order(lp$taxbase),])
lp[as.character(lp$name)=="Esbjerg Kommune",]
summary(lp$taxbase[lp$oppdksup==-1])
lp[lp$oppdksup==-1,]
prop.table(table(lp$oppdksup==-1,lp$taxbase>176800))
2/27
11/58
#fit models with tax base
summary(mod1<-glm(supopp01~taxbase,data=lp,family="binomial"))
summary(mod2<-glm(oppose01~taxbase,data=lp,family="binomial"))
summary(mod3<-lm(oppdksup~taxbase,data=lp))
#model with density
summary(mod4<-lm(oppdksup~taxbase+density,data=lp))
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(position=position_jitter(w = 0.1, h = 0.1),aes(color=factor(oppdksup)),alpha=.8) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none") +
xlab("Beskatningsgrundlag pr. indb.") +
ylab("Støtte til Løkke (-1='nej', 0='ved ikke', +1='ja')")
require(ggplot2)
setwd("~/GitHub/loekkepoll")
pdf(file="taxplot.pdf")
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(position=position_jitter(w = 0.1, h = 0.1),aes(color=factor(oppdksup)),alpha=.8) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none") +
xlab("Beskatningsgrundlag pr. indb.") +
ylab("Støtte til Løkke (-1='nej', 0='ved ikke', +1='ja')")
dev.off()
prop.table(table(lp$oppdksup==-1,lp$taxbase>176800))
table(lp$oppdksup==-1,lp$taxbase>176800)
2/27
12/57
summary(lp$taxbase)
table(lp$oppdksup==-1,lp$taxbase>176800)
lp[as.character(lp$name)=="Esbjerg Kommune",]
lp[as.character(lp$name)=="Silkeborg Kommune",]
View(lp[order(lp$taxbase),])
lp$name[lp$oppdksup==-1]
as.character(lp$name[lp$oppdksup==-1])
require(RCurl)
lp<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/loekkepoll3.csv"))
#kilder: Jacob Packert (@jacobpackert) og Kommunale Nøgletal, noegletal.dk
density<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/density.csv"))
lp<-merge(lp,density,by="knr",all.x=T)
lp$supopp01<-NA
#create support/oppose variable
lp$supopp01[lp$support==1]<-1
lp$supopp01[lp$oppose==1]<-0
#binary opposition
str(lp)
lp$oppose01<-0
lp$oppose01[lp$oppose==1]<-1
str(lp)
#linear variable
lp$oppdksup<-0
lp$oppdksup[lp$oppose==1]<- -1
lp$oppdksup[lp$support==1]<- 1
#summary stats
str(lp)
summary(lp$taxbase)
as.character(lp$name)
View(lp[order(lp$taxbase),])
lp[as.character(lp$name)=="Esbjerg Kommune",]
lp[as.character(lp$name)=="Silkeborg Kommune",]
summary(lp$taxbase[lp$oppdksup==-1])
lp[lp$oppdksup==-1,]
table(lp$oppdksup==-1,lp$taxbase>176800)
2/27
12/57
as.character(lp$name[lp$oppdksup==-1])
#fit models with tax base
summary(mod1<-glm(supopp01~taxbase,data=lp,family="binomial"))
summary(mod2<-glm(oppose01~taxbase,data=lp,family="binomial"))
summary(mod3<-lm(oppdksup~taxbase,data=lp))
#model with density
summary(mod4<-lm(oppdksup~taxbase+density,data=lp))
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(position=position_jitter(w = 0.1, h = 0.1),aes(color=factor(oppdksup)),alpha=.8) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none") +
xlab("Beskatningsgrundlag pr. indb.") +
ylab("Støtte til Løkke (-1='nej', 0='ved ikke', +1='ja')")
table(lp$oppdksup==-1,lp$taxbase>176800)
require(RCurl)
lp<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/loekkepoll3.csv"))
#kilder: Jacob Packert (@jacobpackert) og Kommunale Nøgletal, noegletal.dk
density<-read.csv(text=getURL("https://raw.githubusercontent.com/fghjorth/loekkepoll/master/density.csv"))
lp<-merge(lp,density,by="knr",all.x=T)
lp$supopp01<-NA
#create support/oppose variable
lp$supopp01[lp$support==1]<-1
lp$supopp01[lp$oppose==1]<-0
#binary opposition
str(lp)
lp$oppose01<-0
lp$oppose01[lp$oppose==1]<-1
str(lp)
#linear variable
lp$oppdksup<-0
lp$oppdksup[lp$oppose==1]<- -1
lp$oppdksup[lp$support==1]<- 1
#summary stats
str(lp)
summary(lp$taxbase)
as.character(lp$name)
View(lp[order(lp$taxbase),])
lp[as.character(lp$name)=="Esbjerg Kommune",]
lp[as.character(lp$name)=="Silkeborg Kommune",]
summary(lp$taxbase[lp$oppdksup==-1])
lp[lp$oppdksup==-1,]
table(lp$oppdksup==-1,lp$taxbase>176800)
2/27
12/57
as.character(lp$name[lp$oppdksup==-1])
#fit models with tax base
summary(mod1<-glm(supopp01~taxbase,data=lp,family="binomial"))
summary(mod2<-glm(oppose01~taxbase,data=lp,family="binomial"))
summary(mod3<-lm(oppdksup~taxbase,data=lp))
#model with density
summary(mod4<-lm(oppdksup~taxbase+density,data=lp))
require(ggplot2)
setwd("~/GitHub/loekkepoll")
pdf(file="taxplot.pdf")
ggplot(lp,aes(x=taxbase,y=oppdksup)) +
geom_point(position=position_jitter(w = 0.1, h = 0.1),aes(color=factor(oppdksup)),alpha=.8) +
geom_smooth(method="lm",color="black",alpha=.1) +
theme_bw() +
scale_color_manual(values=c("dark red","gray","dark green")) +
theme(legend.position="none") +
xlab("Beskatningsgrundlag pr. indb.") +
ylab("Støtte til Løkke (-1='nej', 0='ved ikke', +1='ja')")
dev.off()
